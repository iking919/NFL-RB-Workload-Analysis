yards_per_touch = y_tch,
yards_from_scrimmage = yscm,
total_td = rrtd,
fumbles = fmb
)
# ---- 3. Select + rename relevant columns ----
# Your dataset contains multiple yard columns; keep the key ones.
# Note: some years may be missing columns—use select(any_of(...))
rb_data <- scrimmage_all %>%
select(
Season,
# identifiers
Player,
Age,
Team,
Pos,
G,
GS,
# Receiving
Tgt,
Rec,
rec_yards = Yds,         # receiving yards
rec_td = TD,             # receiving TDs
rec_first_down = X1D,    # receiving 1st downs
rec_long = Lng,          # receiving long
rec_yards_per_rec = Y_R, # yards per reception
rec_yards_per_tgt = Y_Tgt,
# Rushing
rush_att = Att,
rush_yards = Yds_1,      # rushing yards
rush_td = TD_1,          # rushing TDs
rush_first_down = X1D_1,
rush_long = Lng_1,
rush_yards_per_att = Y_A,
# Scrimmage totals
touches = Touch,
yards_per_touch = Y_Tch,
yards_from_scrimmage = YScm,
total_td = RRTD,
# Ball security
fumbles = Fmb
)
library(tidyverse)
# ---- 1. Read all CSV files ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# load all scrimmage_XXXX.csv files
file_list <- list.files(pattern = "scrimmage_\\d+\\.csv")
raw_list <- lapply(file_list, function(f) {
year <- str_extract(f, "\\d+")               # pull season from filename
df <- read_csv(f, show_col_types = FALSE)
df$Season <- as.numeric(year)
df
})
# load all scrimmage_XXXX.csv files
file_list <- list.files(pattern = "scrimmage_2024.csv")
raw_list <- lapply(file_list, function(f) {
year <- str_extract(f, "\\d+")               # pull season from filename
df <- read_csv(f, show_col_types = FALSE)
df$Season <- as.numeric(year)
df
})
scrimmage_all <- bind_rows(raw_list)
# ---- 3. Select + rename relevant columns ----
rb_data <- scrimmage_all %>%
select(
Season,
# identifiers
Player,
Age,
Team,
Pos,
G,
GS,
# Receiving
Tgt,
Rec,
rec_yards = Yds,         # receiving yards
rec_td = TD,             # receiving TDs
rec_first_down = X1D,    # receiving 1st downs
rec_long = Lng,          # receiving long
rec_yards_per_rec = Y_R,
rec_yards_per_tgt = Y_Tgt,
# Rushing
rush_att = Att,
rush_yards = Yds_1,      # rushing yards
rush_td = TD_1,
rush_first_down = X1D_1,
rush_long = Lng_1,
rush_yards_per_att = Y_A,
# Scrimmage totals
touches = Touch,
yards_per_touch = Y_Tch,
yards_from_scrimmage = YScm,
total_td = RRTD,
# Ball security
fumbles = Fmb
)
View(scrimmage_all)
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
file_list <- list.files(pattern = "scrimmage_2024.csv")
raw_list <- lapply(file_list, function(f) {
# extract season from filename
year <- str_extract(f, "\\d+")
# read WITHOUT column names
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# row 1 = category headers (ignore)
# row 2 = REAL header names
real_names <- as.character(df[2, ])
# apply real names
df <- df[-1, ]     # drop row 1
colnames(df) <- real_names
# drop the header row (row 2 becomes row 1)
df <- df[-1, ]
df$Season <- as.numeric(year)
df
})
scrimmage_all <- bind_rows(raw_list)
# standardize column names
scrimmage_all <- scrimmage_all %>% clean_names()
# ---- Now your columns exist, so select works ----
rb_data <- scrimmage_all %>%
select(
season,
player,
age,
team,
pos,
g,
gs,
# Receiving
tgt,
rec,
rec_yards = yds,
rec_td = td,
rec_first_down = x1d,
rec_long = lng,
rec_yards_per_rec = y_r,
rec_yards_per_tgt = y_tgt,
# Rushing
rush_att = att,
rush_yards = yds_1,
rush_td = td_1,
rush_first_down = x1d_1,
rush_long = lng_1,
rush_yards_per_att = y_a,
# Scrimmage totals
touches = touch,
yards_per_touch = y_tch,
yards_from_scrimmage = yscm,
total_td = rrtd,
# Ball security
fumbles = fmb
)
# Filter RBs with 50 touches
rb_data <- rb_data %>%
filter(pos == "RB", touches >= 50)
View(scrimmage_all)
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
file_list <- list.files(pattern = "scrimmage_2024.csv")
raw_list <- lapply(file_list, function(f) {
# Extract season from filename
year <- str_extract(f, "\\d+")
# Read WITHOUT headers (important!)
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = categories (Receiving / Rushing / Scrimmage / etc.)
cat_row <- as.character(df[1, ])
# Row 2 = variable names (Player / Age / Yds / TD / etc.)
var_row <- as.character(df[2, ])
# Build final names: Category_VarName
new_names <- ifelse(
is.na(cat_row) | cat_row == "",
var_row,
paste0(cat_row, "_", var_row)
)
# Clean: replace spaces, slashes, etc.
new_names <- make.names(new_names, unique = TRUE)
# Remove the first two header rows
df <- df[-c(1, 2), ]
# Apply new names
colnames(df) <- new_names
# Add Season column
df$Season <- as.numeric(year)
df
})
scrimmage_all <- bind_rows(raw_list)
View(scrimmage_all)
rb_data <- scrimmage_all %>%
select(
Season,
Player = contains("_Player"),
Age = contains("_Age"),
Team = contains("_Team"),
Pos = contains("_Pos"),
G = contains("_G"),
GS = contains("_GS"),
# Receiving
Rec = contains("Receiving_Rec"),
Tgt = contains("Receiving_Tgt"),
rec_yards = contains("Receiving_Yds"),
rec_td = contains("Receiving_TD"),
rec_first_down = contains("Receiving_1D"),
rec_long = contains("Receiving_Lng"),
rec_yards_per_rec = contains("Receiving_Y.R"),
rec_yards_per_tgt = contains("Receiving_Y.Tgt"),
# Rushing
rush_att = contains("Rushing_Att"),
rush_yards = contains("Rushing_Yds"),
rush_td = contains("Rushing_TD"),
rush_first_down = contains("Rushing_1D"),
rush_long = contains("Rushing_Lng"),
rush_yards_per_att = contains("Rushing_Y.A"),
# Scrimmage totals
touches = contains("Scrimmage_Touch"),
yards_per_touch = contains("Scrimmage_Y.Tch"),
yards_from_scrimmage = contains("Scrimmage_YScm"),
total_td = contains("Scrimmage_RRTD"),
fumbles = contains("Fmb")
) %>%
filter(Pos == "RB", touches >= 50) %>%
mutate(
touches_per_game = touches / G,
yards_per_game = yards_from_scrimmage / G
)
rb_data <- scrimmage_all %>%
select(
Season,
Player = contains("Player"),
Age = contains("Age"),
Team = contains("Team"),
Pos = contains("Pos"),
G = contains("G"),
GS = contains("GS"),
# Receiving
Rec = contains("Receiving_Rec"),
Tgt = contains("Receiving_Tgt"),
rec_yards = contains("Receiving_Yds"),
rec_td = contains("Receiving_TD"),
rec_first_down = contains("Receiving_1D"),
rec_long = contains("Receiving_Lng"),
rec_yards_per_rec = contains("Receiving_Y.R"),
rec_yards_per_tgt = contains("Receiving_Y.Tgt"),
# Rushing
rush_att = contains("Rushing_Att"),
rush_yards = contains("Rushing_Yds"),
rush_td = contains("Rushing_TD"),
rush_first_down = contains("Rushing_1D"),
rush_long = contains("Rushing_Lng"),
rush_yards_per_att = contains("Rushing_Y.A"),
# Scrimmage totals
touches = contains("Scrimmage_Touch"),
yards_per_touch = contains("Scrimmage_Y.Tch"),
yards_from_scrimmage = contains("Scrimmage_YScm"),
total_td = contains("Scrimmage_RRTD"),
fumbles = contains("Fmb")
) %>%
filter(Pos == "RB", touches >= 50) %>%
mutate(
touches_per_game = touches / G,
yards_per_game = yards_from_scrimmage / G
)
names(scrimmage_all)[str_detect(names(scrimmage_all), "G")]
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_2024.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = real column names
colnames(df) <- as.character(df[2, ])
# Drop the first two rows (category + column names)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# ---- 5. Keep RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Scrimmage_Touch >= 50) %>%
mutate(
touches_per_game = Scrimmage_Touch / as.numeric(G),
yards_per_game = Scrimmage_YScm / as.numeric(G)
)
# -----------------------------
# R Script: Combine NFL RB Scrimmage Data
# -----------------------------
library(tidyverse)
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_2024.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = real column names
colnames(df) <- as.character(df[2, ])
# Drop the first two rows (category + column names)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# ---- 5. Keep RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Touch >= 50) %>%
mutate(
touches_per_game = Touch / as.numeric(G),
yards_per_game = Scrimmage_YScm / as.numeric(G)
)
# -----------------------------
# R Script: Combine NFL RB Scrimmage Data
# -----------------------------
library(tidyverse)
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_2024.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = variable names
category_row <- as.character(df[1, ])
var_row      <- as.character(df[2, ])
# Combine to make names like Receiving_Yds, Rushing_Att, etc.
new_names <- ifelse(category_row == "" | is.na(category_row),
var_row,
paste0(category_row, "_", var_row))
# Clean names: remove spaces and special characters
new_names <- make.names(new_names, unique = TRUE)
colnames(df) <- new_names
# Drop the first two rows (category + original header)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# ---- 5. Keep RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Scrimmage_Touch >= 50) %>%
mutate(
touches_per_game = as.numeric(Scrimmage_Touch) / as.numeric(G),
yards_per_game = as.numeric(Scrimmage_YScm) / as.numeric(G)
)
# ---- 6. Export cleaned dataset ----
write_csv(rb_data, "rb_data.csv")
cat("Successfully created rb_data.csv with", nrow(rb_data), "rows.\n")
View(rb_data)
# -----------------------------
# R Script: Combine NFL RB Scrimmage Data
# -----------------------------
library(tidyverse)
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_2024.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = variable names
category_row <- as.character(df[1, ])
var_row      <- as.character(df[2, ])
# Combine to make names like Receiving_Yds, Rushing_Att, etc.
new_names <- ifelse(category_row == "" | is.na(category_row),
var_row,
paste0(category_row, "_", var_row))
# Clean names: remove spaces and special characters
new_names <- make.names(new_names, unique = TRUE)
colnames(df) <- new_names
# Drop the first two rows (category + original header)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# Convert key numeric columns to numeric type
numeric_cols <- c("G", "GS", "Scrimmage_Touch", "Scrimmage_YScm",
"Receiving_Yds", "Receiving_TD", "Rushing_Yds", "Rushing_TD")
numeric_cols <- numeric_cols[numeric_cols %in% names(scrimmage_all)] # only existing columns
scrimmage_all[numeric_cols] <- lapply(scrimmage_all[numeric_cols], function(x) as.numeric(as.character(x)))
# ---- 5. Keep RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Scrimmage_Touch >= 50) %>%
mutate(
touches_per_game = as.numeric(Scrimmage_Touch) / as.numeric(G),
yards_per_game = as.numeric(Scrimmage_YScm) / as.numeric(G)
)
# ---- 6. Export cleaned dataset ----
write_csv(rb_data, "rb_data.csv")
cat("Successfully created rb_data.csv with", nrow(rb_data), "rows.\n")
View(rb_data)
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_.*\\.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = variable names
category_row <- as.character(df[1, ])
var_row      <- as.character(df[2, ])
# Combine to make names like Receiving_Yds, Rushing_Att, etc.
new_names <- ifelse(category_row == "" | is.na(category_row),
var_row,
paste0(category_row, "_", var_row))
# Clean names: remove spaces and special characters
new_names <- make.names(new_names, unique = TRUE)
colnames(df) <- new_names
# Drop the first two rows (category + original header)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# Convert key numeric columns to numeric type
numeric_cols <- c("G", "GS", "Scrimmage_Touch", "Scrimmage_YScm",
"Receiving_Yds", "Receiving_TD", "Rushing_Yds", "Rushing_TD")
numeric_cols <- numeric_cols[numeric_cols %in% names(scrimmage_all)] # only existing columns
scrimmage_all[numeric_cols] <- lapply(scrimmage_all[numeric_cols], function(x) as.numeric(as.character(x)))
# ---- 5. Keep RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Scrimmage_Touch >= 50) %>%
mutate(
touches_per_game = as.numeric(Scrimmage_Touch) / as.numeric(G),
yards_per_game = as.numeric(Scrimmage_YScm) / as.numeric(G)
)
# ---- 6. Export cleaned dataset ----
write_csv(rb_data, "rb_data.csv")
cat("Successfully created rb_data.csv with", nrow(rb_data), "rows.\n")
View(rb_data)
# -----------------------------
# R Script: Combine NFL RB Scrimmage Data with Ranks
# -----------------------------
library(tidyverse)
# ---- 1. Set working directory ----
setwd("C:/Users/kingi/Documents/school/Data Analytics/assignment4/data")
# ---- 2. List all scrimmage CSV files ----
file_list <- list.files(pattern = "scrimmage_.*\\.csv$")
# ---- 3. Read all files and add Season column ----
raw_list <- lapply(file_list, function(f) {
# Extract season from filename (e.g., scrimmage_1996.csv → 1996)
season <- as.numeric(str_extract(f, "\\d+"))
# Read CSV without header
df <- read_csv(f, col_names = FALSE, show_col_types = FALSE)
# Row 1 = category headers, Row 2 = variable names
category_row <- as.character(df[1, ])
var_row      <- as.character(df[2, ])
# Combine to make names like Receiving_Yds, Rushing_Att, etc.
new_names <- ifelse(category_row == "" | is.na(category_row),
var_row,
paste0(category_row, "_", var_row))
# Clean names: remove spaces and make unique
new_names <- make.names(new_names, unique = TRUE)
colnames(df) <- new_names
# Drop the first two rows (category + header)
df <- df[-c(1,2), ]
# Add Season column
df$Season <- season
df
})
# ---- 4. Combine all years into one dataframe ----
scrimmage_all <- bind_rows(raw_list)
# ---- 5. Convert key numeric columns ----
numeric_cols <- c("G", "GS", "Scrimmage_Touch", "Scrimmage_YScm",
"Receiving_Yds", "Receiving_TD", "Rushing_Yds", "Rushing_TD",
"Rk")
numeric_cols <- numeric_cols[numeric_cols %in% names(scrimmage_all)] # only existing columns
scrimmage_all[numeric_cols] <- lapply(scrimmage_all[numeric_cols], function(x) as.numeric(as.character(x)))
# ---- 6. Filter RBs with ≥50 touches ----
rb_data <- scrimmage_all %>%
filter(Pos == "RB", Scrimmage_Touch >= 50) %>%
mutate(
touches_per_game = Scrimmage_Touch / G,
yards_per_game = Scrimmage_YScm / G
)
# ---- 7. Rename original Rk to season_rank ----
if("Rk" %in% names(rb_data)){
rb_data <- rb_data %>% rename(Season_Rank = Rk)
}
# ---- 8. Create total_yds_rank across all seasons ----
rb_data <- rb_data %>%
arrange(desc(Scrimmage_YScm)) %>%
mutate(Total_Rank = row_number())
# ---- 9. Export cleaned dataset ----
write_csv(rb_data, "rb_data.csv")
cat("Successfully created rb_data.csv with", nrow(rb_data), "rows.\n")
View(scrimmage_all)
View(rb_data)
